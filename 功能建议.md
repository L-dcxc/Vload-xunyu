# VLoad 功能建议（基于 SCPI 协议）

## 已实现功能 ✅
1. **基础连接**：TCP/COM 串口连接
2. **四种工作模式**：CC（恒流）、CV（恒压）、CP（恒功率）、CR（恒电阻）
3. **实时监控**：电压、电流、功率、内阻曲线显示
4. **参数设置**：各模式的参数配置和保护值设置
5. **数据记录**：数据表格记录和导出（CSV/Excel）
6. **波形导入**：支持导入本软件导出的数据文件
7. **SCPI 终端**：直接发送 SCPI 命令
8. **帮助信息**：关于对话框

---

## 建议新增功能（按优先级排序）

### 🔥 高优先级功能

#### 1. **动态模式（DYNA）**
- **功能描述**：实现高低电流交替拉载，用于测试电源的动态响应
- **SCPI 命令**：
  - `DYN:HIGH <value>` - 设置高准位电流
  - `DYN:LOW <value>` - 设置低准位电流
  - `DYN:HIGH:DWELL <time>` - 高准位持续时间
  - `DYN:LOW:DWELL <time>` - 低准位持续时间
  - `DYN:SLEW <rate>` - 电流斜率
- **应用场景**：测试电源的瞬态响应、纹波等
- **UI 建议**：在控制面板添加"动态模式"选项，包含高/低电流、持续时间、斜率设置

#### 2. **OCP 过流保护测试**
- **功能描述**：自动测试电源的过流保护点
- **SCPI 命令**：
  - `OCP:IST <current>` - 起始电流
  - `OCP:IEND <current>` - 截止电流
  - `OCP:STEP <steps>` - 步数
  - `OCP:DWELL <time>` - 单步驻留时间
  - `OCP:VTR <voltage>` - 触发电平
  - `OCP:RES?` - 查询 OCP 点
  - `OCP:RES:PMAX?` - 查询最大功率点
- **应用场景**：电源 OCP 功能验证
- **UI 建议**：新增"OCP 测试"页面，自动扫描并绘制 OCP 曲线

#### 3. **电压/电流峰值测量**
- **功能描述**：测量电压/电流的峰值、最小值、峰峰值
- **SCPI 命令**：
  - `MEAS:VOLT:MAX?` - 电压峰值 Vp+
  - `MEAS:VOLT:MIN?` - 电压最小值 Vp-
  - `MEAS:VOLT:PTP?` - 电压峰峰值 Vpp
  - `MEAS:CURR:MAX?` - 电流峰值 Ip+
  - `MEAS:CURR:MIN?` - 电流最小值 Ip-
  - `MEAS:CURR:PTP?` - 电流峰峰值 Ipp
- **应用场景**：纹波测试、瞬态响应分析
- **UI 建议**：在实时监控区域显示峰值数据

#### 4. **电流/电压斜率控制**
- **功能描述**：精确控制电流/电压的上升和下降速率
- **SCPI 命令**：
  - `CURR:SLEW:RISE <rate>` - 电流上升率
  - `CURR:SLEW:FALL <rate>` - 电流下降率
  - `VOLT:SLEW <rate>` - 电压斜率
- **应用场景**：软启动测试、防止电源过冲
- **UI 建议**：在参数设置中添加上升/下降率独立控制

---

### ⭐ 中优先级功能

#### 5. **LIST 模式（序列测试）**
- **功能描述**：按预设序列执行多步测试
- **SCPI 命令**：
  - `LIST:CURR <i1>,<i2>,<i3>...` - 设置每步电流
  - `LIST:DWELL <t1>,<t2>,<t3>...` - 设置每步时间
  - `LIST:COUN <count>` - 执行次数
  - `LIST:STEP <ONCE|AUTO>` - 触发模式
  - `LIST:SAV <file>` - 保存序列
  - `LIST:RCL <file>` - 加载序列
- **应用场景**：复杂的多阶段测试、老化测试
- **UI 建议**：完善"任务序列"页面，支持可视化编辑和保存

#### 6. **Timing 时序测试**
- **功能描述**：测量电源启动/关断时间
- **SCPI 命令**：
  - `TIM:LOAD:MODE <mode>` - 带载模式
  - `TIM:LOAD:VAL <value>` - 带载值
  - `TIM:TST:SOUR <VOLT|CURR|EXT>` - 启动触发源
  - `TIM:TST:EDGE <RISE|FALL>` - 触发沿
  - `TIM:TST:LEV <level>` - 触发电平
  - `TIM:TEND:*` - 结束触发设置
  - `TIM:RES?` - 查询结果
- **应用场景**：电源启动时间、关断时间测试
- **UI 建议**：新增"时序测试"页面

#### 7. **Load Effect 负载调整率测试**
- **功能描述**：测试电源的负载调整率和内阻
- **SCPI 命令**：
  - `LEFF:IMIN <current>` - 低准位电流
  - `LEFF:IMAX <current>` - 高准位电流
  - `LEFF:INORM <current>` - 正常电流
  - `LEFF:DEL <time>` - 拉载时间
  - `LEFF:RES:VOLT?` - 查询电压差
  - `LEFF:RES:RES?` - 查询内阻
  - `LEFF:RES:REG?` - 查询负载调整率
- **应用场景**：电源性能评估
- **UI 建议**：新增"负载调整率测试"页面

#### 8. **LED 模式**
- **功能描述**：专门用于 LED 驱动器测试
- **SCPI 命令**：
  - `LED:VOLT <voltage>` - 设置 LED Vo
  - `LED:CURR <current>` - 设置 LED Io
  - `LED:RCO <coeff>` - 设置 Rd 系数
- **应用场景**：LED 驱动器测试
- **UI 建议**：在模式选择中添加"LED"模式

---

### 💡 低优先级功能

#### 9. **档位切换**
- **功能描述**：手动切换电流/电压档位以提高精度
- **SCPI 命令**：
  - `CURR:RANG <range>` - 电流档位
  - `VOLT:RANG <range>` - 电压档位
- **应用场景**：小电流/电压精确测量
- **UI 建议**：在参数设置中添加档位选择

#### 10. **远端补偿**
- **功能描述**：补偿测试线缆压降
- **SCPI 命令**：
  - `SYST:SENS <ON|OFF>` - 开启/关闭远端补偿
- **应用场景**：高精度测量
- **UI 建议**：在设置中添加开关

#### 11. **蜂鸣器控制**
- **功能描述**：控制设备蜂鸣器
- **SCPI 命令**：
  - `SYST:BEEP:STAT <ON|OFF>` - 使能/禁止蜂鸣器
- **应用场景**：测试完成提示
- **UI 建议**：在设置中添加开关

#### 12. **输入短路功能**
- **功能描述**：短路输入端（不改变 on/off 状态）
- **SCPI 命令**：
  - `INPUT:SHOR <ON|OFF>` - 使能/禁止短路
- **应用场景**：特殊测试需求
- **UI 建议**：在控制面板添加按钮

#### 13. **Von/Voff 设置**
- **功能描述**：设置负载开始带载和卸载的电压阈值
- **SCPI 命令**：
  - `VOLT:ON <voltage>` - 带载电压
  - `VOLT:OFF <voltage>` - 卸载电压
- **应用场景**：自动带载控制
- **UI 建议**：在高级设置中添加

#### 14. **AUTO 自动测试模式**
- **功能描述**：执行预设的自动测试文件
- **SCPI 命令**：
  - `AUTO:FILE <file>,<seq>` - 设置文件和序号
- **应用场景**：批量自动化测试
- **UI 建议**：新增"自动测试"页面

---

## 功能实现建议顺序

1. **第一阶段**（核心测试功能）
   - 动态模式（DYNA）
   - OCP 过流保护测试
   - 电压/电流峰值测量
   - 电流/电压斜率独立控制

2. **第二阶段**（高级测试功能）
   - LIST 序列测试（完善现有页面）
   - Timing 时序测试
   - Load Effect 负载调整率测试

3. **第三阶段**（专用功能）
   - LED 模式
   - 档位切换
   - 远端补偿

4. **第四阶段**（辅助功能）
   - 蜂鸣器控制
   - 输入短路
   - Von/Voff 设置
   - AUTO 自动测试

---

## 其他建议

### UI/UX 改进
- 添加快捷键支持（如 F1 帮助、Ctrl+S 保存等）
- 添加主题切换（深色/浅色）
- 添加曲线缩放、平移功能
- 添加数据标记和注释功能
- 添加测试报告生成功能（PDF）

### 数据分析
- 添加统计分析（平均值、标准差、最大最小值）
- 添加 FFT 频谱分析（用于纹波分析）
- 添加数据对比功能（多次测试对比）

### 自动化
- 添加脚本录制和回放功能
- 添加定时任务功能
- 添加远程控制 API（HTTP/WebSocket）

---

**建议优先实现动态模式和 OCP 测试，这两个是电源测试中最常用的功能。**
